// We can easily verify that none of the entries in the first seven rows of Pascal's
// triangle are divisible by 7:
//
//                      1
//                    1   1
//                  1   2   1
//                1   3   3   1
//              1   4   6   4   1
//            1   5   10  10  5   1
//          1   6   15  20  15  6   1
//
// However, if we check the first one hundred rows, we will find that only
// 2361 of the 5050 entries are not divisible by 7.
//
// Find the number of entries which are not divisible by in the first
// one billion(10^9) rows of Pascal's triangle.


#include <cstdint>
#include <iostream>
#include <numeric>
#include <vector>


// Look at the next couple lines to see which ones are divisble by 7:
//                1     6    15    20    15     6     1
//             1     7    21    35    35    21     7     1
//          1     8    28    56    70    56    28     8     1
//       1     9    36    84   126   126    84    36     9     1

// The most obvious pattern is that each row is symmetric, which makes sense since
// you can swap a & b in the (a + b)^n expansion and get the same sum.
// Next is that every number on the 7th row except the terminal 1's is a multiple of 7.
// On the 8th row, it's every number within the 28s inclusive.  On the 9th, inside the 84s.
// 

// Let's continue creating rows to look at the values and patterns:
//                             1     7    21    35    35    21     7     1
//                          1     8    28    56    70    56    28     8     1
//                       1     9    36    84   126   126    84    36     9     1
//                    1    10    45   120   210   252   210   120    45    10     1
//                 1    11    55   165   330   462   462   330   165    55    11     1
//              1    12    66   220   495   792   924   792   495   220    66    12     1
//           1    13    78   286   715  1287  1716  1716  1287   715   286    78    13     1
//        1    14    91   364  1001  2002  3003  3432  3003  2002  1001   364    91    14     1
//     1    15   105   455  1365  3003  5005  6435  6435  5005  3003  1365   455   105    15     1
//  1    16   120   560  1820  4368  8008 11440 12870 11440  8008  4368  1820   560   120    16     1

// It is easier to see the patterns when you look at the rows mod 7:                                       mult of 7   not     total   base 7
//  1                                                 1                                                     - 0         1        1       1
//  2                                               1   1                                                   - 0         2        3       2
//  3                                             1   2   1                                                 - 0         3        6       3
//  4                                           1   3   3   1                                               - 0         4       10       4
//  5                                         1   4   6   4   1                                             - 0         5       15       5
//  6                                       1   5   3   3   5   1                                           - 0         6       21       6
//  7                                     1   6   1   6   1   6   1                                         - 0         7       28      10
//  8                                   1   0   0   0   0   0   0   1                                       - 6         2       30      11
//  9                                 1   1   0   0   0   0   0   1   1                                     - 5         4       34      12
// 10                               1   2   1   0   0   0   0   1   2   1                                   - 4         6       40      13
// 11                             1   3   3   1   0   0   0   1   3   3   1                                 - 3         8       48      14
// 12                           1   4   6   4   1   0   0   1   4   6   4   1                               - 2        10       58      15
// 13                         1   5   3   3   5   1   0   1   5   3   3   5   1                             - 1        12       70      16
// 14                       1   6   1   6   1   6   1   1   6   1   6   1   6   1                           - 0        14       84      20
// 15                     1   0   0   0   0   0   0   2   0   0   0   0   0   0   1                         - 12        3       87      21
// 16                   1   1   0   0   0   0   0   2   2   0   0   0   0   0   1   1                       - 10        6       93      22
// 17                 1   2   1   0   0   0   0   2   4   2   0   0   0   0   1   2   1                     - 8         9      102      23
// 18               1   3   3   1   0   0   0   2   6   6   2   0   0   0   1   3   3   1                   - 6        12      114      24
// 19             1   4   6   4   1   0   0   2   1   5   1   2   0   0   1   4   6   4   1                 - 4        15      129      25
// 20           1   5   3   3   5   1   0   2   3   6   6   3   2   0   1   5   3   3   5   1               - 2        18      147      26
// 21         1   6   1   6   1   6   1   2   5   2   5   2   5   2   1   6   1   6   1   6   1             - 0        21      168      30
// 22       1   0   0   0   0   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   1           - 18        4      172      31
// 23     1   1   0   0   0   0   0   3   3   0   0   0   0   0   3   3   0   0   0   0   0   1   1         - 15        8      180      32
// 24   1   2   1   0   0   0   0   3   6   3   0   0   0   0   3   6   3   0   0   0   0   1   2   1       - 12       12      192      33
//
// You can see inverted triangles of 0s, indicating multiples of 7 in the larger triangle.  Because 7 is
// prime, the modular arithmetic has a period of 7, as evidenced by the number of 0s in each row.  From
// row 7 on, the pattern looks like k*(6, 5, 4, 3, 2, 1, 0), where k = row div 7.
//

// Here is the first 100 rows, with the 2361 non-multiples of 7:
//  row  base 7    not   total
//  1       1       1       1                                                                                                                                                                                                         1
//  2       2       2       3                                                                                                                                                                                                       1   1
//  3       3       3       6                                                                                                                                                                                                     1   2   1
//  4       4       4      10                                                                                                                                                                                                   1   3   3   1
//  5       5       5      15                                                                                                                                                                                                 1   4   6   4   1
//  6       6       6      21                                                                                                                                                                                               1   5   3   3   5   1
//  7      10       7      28                                                                                                                                                                                             1   6   1   6   1   6   1
//  8      11       2      30                                                                                                                                                                                           1   0   0   0   0   0   0   1
//  9      12       4      34                                                                                                                                                                                         1   1   0   0   0   0   0   1   1
// 10      13       6      40                                                                                                                                                                                       1   2   1   0   0   0   0   1   2   1
// 11      14       8      48                                                                                                                                                                                     1   3   3   1   0   0   0   1   3   3   1
// 12      15      10      58                                                                                                                                                                                   1   4   6   4   1   0   0   1   4   6   4   1
// 13      16      12      70                                                                                                                                                                                 1   5   3   3   5   1   0   1   5   3   3   5   1
// 14      20      14      84                                                                                                                                                                               1   6   1   6   1   6   1   1   6   1   6   1   6   1
// 15      21       3      87                                                                                                                                                                             1   0   0   0   0   0   0   2   0   0   0   0   0   0   1
// 16      22       6      93                                                                                                                                                                           1   1   0   0   0   0   0   2   2   0   0   0   0   0   1   1
// 17      23       9     102                                                                                                                                                                         1   2   1   0   0   0   0   2   4   2   0   0   0   0   1   2   1
// 18      24      12     114                                                                                                                                                                       1   3   3   1   0   0   0   2   6   6   2   0   0   0   1   3   3   1
// 19      25      15     129                                                                                                                                                                     1   4   6   4   1   0   0   2   1   5   1   2   0   0   1   4   6   4   1
// 20      26      18     147                                                                                                                                                                   1   5   3   3   5   1   0   2   3   6   6   3   2   0   1   5   3   3   5   1
// 21      30      21     168                                                                                                                                                                 1   6   1   6   1   6   1   2   5   2   5   2   5   2   1   6   1   6   1   6   1
// 22      31       4     172                                                                                                                                                               1   0   0   0   0   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   1
// 23      32       8     180                                                                                                                                                             1   1   0   0   0   0   0   3   3   0   0   0   0   0   3   3   0   0   0   0   0   1   1
// 24      33      12     192                                                                                                                                                           1   2   1   0   0   0   0   3   6   3   0   0   0   0   3   6   3   0   0   0   0   1   2   1
// 25      34      16     208                                                                                                                                                         1   3   3   1   0   0   0   3   2   2   3   0   0   0   3   2   2   3   0   0   0   1   3   3   1
// 26      35      20     228                                                                                                                                                       1   4   6   4   1   0   0   3   5   4   5   3   0   0   3   5   4   5   3   0   0   1   4   6   4   1
// 27      36      24     252                                                                                                                                                     1   5   3   3   5   1   0   3   1   2   2   1   3   0   3   1   2   2   1   3   0   1   5   3   3   5   1
// 28      40      28     280                                                                                                                                                   1   6   1   6   1   6   1   3   4   3   4   3   4   3   3   4   3   4   3   4   3   1   6   1   6   1   6   1
// 29      41       5     285                                                                                                                                                 1   0   0   0   0   0   0   4   0   0   0   0   0   0   6   0   0   0   0   0   0   4   0   0   0   0   0   0   1
// 30      42      10     295                                                                                                                                               1   1   0   0   0   0   0   4   4   0   0   0   0   0   6   6   0   0   0   0   0   4   4   0   0   0   0   0   1   1
// 31      43      15     310                                                                                                                                             1   2   1   0   0   0   0   4   1   4   0   0   0   0   6   5   6   0   0   0   0   4   1   4   0   0   0   0   1   2   1
// 32      44      20     330                                                                                                                                           1   3   3   1   0   0   0   4   5   5   4   0   0   0   6   4   4   6   0   0   0   4   5   5   4   0   0   0   1   3   3   1
// 33      45      25     355                                                                                                                                         1   4   6   4   1   0   0   4   2   3   2   4   0   0   6   3   1   3   6   0   0   4   2   3   2   4   0   0   1   4   6   4   1
// 34      46      30     385                                                                                                                                       1   5   3   3   5   1   0   4   6   5   5   6   4   0   6   2   4   4   2   6   0   4   6   5   5   6   4   0   1   5   3   3   5   1
// 35      50      35     420                                                                                                                                     1   6   1   6   1   6   1   4   3   4   3   4   3   4   6   1   6   1   6   1   6   4   3   4   3   4   3   4   1   6   1   6   1   6   1
// 36      51       6     426                                                                                                                                   1   0   0   0   0   0   0   5   0   0   0   0   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   5   0   0   0   0   0   0   1
// 37      52      12     438                                                                                                                                 1   1   0   0   0   0   0   5   5   0   0   0   0   0   3   3   0   0   0   0   0   3   3   0   0   0   0   0   5   5   0   0   0   0   0   1   1
// 38      53      18     456                                                                                                                               1   2   1   0   0   0   0   5   3   5   0   0   0   0   3   6   3   0   0   0   0   3   6   3   0   0   0   0   5   3   5   0   0   0   0   1   2   1
// 39      54      24     480                                                                                                                             1   3   3   1   0   0   0   5   1   1   5   0   0   0   3   2   2   3   0   0   0   3   2   2   3   0   0   0   5   1   1   5   0   0   0   1   3   3   1
// 40      55      30     510                                                                                                                           1   4   6   4   1   0   0   5   6   2   6   5   0   0   3   5   4   5   3   0   0   3   5   4   5   3   0   0   5   6   2   6   5   0   0   1   4   6   4   1
// 41      56      36     546                                                                                                                         1   5   3   3   5   1   0   5   4   1   1   4   5   0   3   1   2   2   1   3   0   3   1   2   2   1   3   0   5   4   1   1   4   5   0   1   5   3   3   5   1
// 42      60      42     588                                                                                                                       1   6   1   6   1   6   1   5   2   5   2   5   2   5   3   4   3   4   3   4   3   3   4   3   4   3   4   3   5   2   5   2   5   2   5   1   6   1   6   1   6   1
// 43      61       7     595                                                                                                                     1   0   0   0   0   0   0   6   0   0   0   0   0   0   1   0   0   0   0   0   0   6   0   0   0   0   0   0   1   0   0   0   0   0   0   6   0   0   0   0   0   0   1
// 44      62      14     609                                                                                                                   1   1   0   0   0   0   0   6   6   0   0   0   0   0   1   1   0   0   0   0   0   6   6   0   0   0   0   0   1   1   0   0   0   0   0   6   6   0   0   0   0   0   1   1
// 45      63      21     630                                                                                                                 1   2   1   0   0   0   0   6   5   6   0   0   0   0   1   2   1   0   0   0   0   6   5   6   0   0   0   0   1   2   1   0   0   0   0   6   5   6   0   0   0   0   1   2   1
// 46      64      28     658                                                                                                               1   3   3   1   0   0   0   6   4   4   6   0   0   0   1   3   3   1   0   0   0   6   4   4   6   0   0   0   1   3   3   1   0   0   0   6   4   4   6   0   0   0   1   3   3   1
// 47      65      35     693                                                                                                             1   4   6   4   1   0   0   6   3   1   3   6   0   0   1   4   6   4   1   0   0   6   3   1   3   6   0   0   1   4   6   4   1   0   0   6   3   1   3   6   0   0   1   4   6   4   1
// 48      66      42     735                                                                                                           1   5   3   3   5   1   0   6   2   4   4   2   6   0   1   5   3   3   5   1   0   6   2   4   4   2   6   0   1   5   3   3   5   1   0   6   2   4   4   2   6   0   1   5   3   3   5   1
// 49     100      49     784                                                                                                         1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1
// 50     101       2     786                                                                                                       1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1
// 51     102       4     790                                                                                                     1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1
// 52     103       6     796                                                                                                   1   2   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   2   1
// 53     104       8     804                                                                                                 1   3   3   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   3   3   1
// 54     105      10     814                                                                                               1   4   6   4   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   4   6   4   1
// 55     106      12     826                                                                                             1   5   3   3   5   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   5   3   3   5   1
// 56     110      14     840                                                                                           1   6   1   6   1   6   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   6   1   6   1   6   1
// 57     111       4     844                                                                                         1   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   1
// 58     112       8     852                                                                                       1   1   0   0   0   0   0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   0   0   0   0   1   1
// 59     113      12     864                                                                                     1   2   1   0   0   0   0   1   2   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   2   1   0   0   0   0   1   2   1
// 60     114      16     880                                                                                   1   3   3   1   0   0   0   1   3   3   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   3   3   1   0   0   0   1   3   3   1
// 61     115      20     900                                                                                 1   4   6   4   1   0   0   1   4   6   4   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   4   6   4   1   0   0   1   4   6   4   1
// 62     116      24     924                                                                               1   5   3   3   5   1   0   1   5   3   3   5   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   5   3   3   5   1   0   1   5   3   3   5   1
// 63     120      28     952                                                                             1   6   1   6   1   6   1   1   6   1   6   1   6   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   6   1   6   1   6   1   1   6   1   6   1   6   1
// 64     121       6     958                                                                           1   0   0   0   0   0   0   2   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   2   0   0   0   0   0   0   1
// 65     122      12     970                                                                         1   1   0   0   0   0   0   2   2   0   0   0   0   0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   0   0   0   0   2   2   0   0   0   0   0   1   1
// 66     123      18     988                                                                       1   2   1   0   0   0   0   2   4   2   0   0   0   0   1   2   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   2   1   0   0   0   0   2   4   2   0   0   0   0   1   2   1
// 67     124      24    1012                                                                     1   3   3   1   0   0   0   2   6   6   2   0   0   0   1   3   3   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   3   3   1   0   0   0   2   6   6   2   0   0   0   1   3   3   1
// 68     125      30    1042                                                                   1   4   6   4   1   0   0   2   1   5   1   2   0   0   1   4   6   4   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   4   6   4   1   0   0   2   1   5   1   2   0   0   1   4   6   4   1
// 69     126      36    1078                                                                 1   5   3   3   5   1   0   2   3   6   6   3   2   0   1   5   3   3   5   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   5   3   3   5   1   0   2   3   6   6   3   2   0   1   5   3   3   5   1
// 70     130      42    1120                                                               1   6   1   6   1   6   1   2   5   2   5   2   5   2   1   6   1   6   1   6   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   6   1   6   1   6   1   2   5   2   5   2   5   2   1   6   1   6   1   6   1
// 71     131       8    1128                                                             1   0   0   0   0   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   1
// 72     132      16    1144                                                           1   1   0   0   0   0   0   3   3   0   0   0   0   0   3   3   0   0   0   0   0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   0   0   0   0   3   3   0   0   0   0   0   3   3   0   0   0   0   0   1   1
// 73     133      24    1168                                                         1   2   1   0   0   0   0   3   6   3   0   0   0   0   3   6   3   0   0   0   0   1   2   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   2   1   0   0   0   0   3   6   3   0   0   0   0   3   6   3   0   0   0   0   1   2   1
// 74     134      32    1200                                                       1   3   3   1   0   0   0   3   2   2   3   0   0   0   3   2   2   3   0   0   0   1   3   3   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   3   3   1   0   0   0   3   2   2   3   0   0   0   3   2   2   3   0   0   0   1   3   3   1
// 75     135      40    1240                                                     1   4   6   4   1   0   0   3   5   4   5   3   0   0   3   5   4   5   3   0   0   1   4   6   4   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   4   6   4   1   0   0   3   5   4   5   3   0   0   3   5   4   5   3   0   0   1   4   6   4   1
// 76     136      48    1288                                                   1   5   3   3   5   1   0   3   1   2   2   1   3   0   3   1   2   2   1   3   0   1   5   3   3   5   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   5   3   3   5   1   0   3   1   2   2   1   3   0   3   1   2   2   1   3   0   1   5   3   3   5   1
// 77     140      56    1344                                                 1   6   1   6   1   6   1   3   4   3   4   3   4   3   3   4   3   4   3   4   3   1   6   1   6   1   6   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   6   1   6   1   6   1   3   4   3   4   3   4   3   3   4   3   4   3   4   3   1   6   1   6   1   6   1
// 78     141      10    1354                                               1   0   0   0   0   0   0   4   0   0   0   0   0   0   6   0   0   0   0   0   0   4   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   4   0   0   0   0   0   0   6   0   0   0   0   0   0   4   0   0   0   0   0   0   1
// 79     142      20    1374                                             1   1   0   0   0   0   0   4   4   0   0   0   0   0   6   6   0   0   0   0   0   4   4   0   0   0   0   0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   0   0   0   0   4   4   0   0   0   0   0   6   6   0   0   0   0   0   4   4   0   0   0   0   0   1   1
// 80     143      30    1404                                           1   2   1   0   0   0   0   4   1   4   0   0   0   0   6   5   6   0   0   0   0   4   1   4   0   0   0   0   1   2   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   2   1   0   0   0   0   4   1   4   0   0   0   0   6   5   6   0   0   0   0   4   1   4   0   0   0   0   1   2   1
// 81     144      40    1444                                         1   3   3   1   0   0   0   4   5   5   4   0   0   0   6   4   4   6   0   0   0   4   5   5   4   0   0   0   1   3   3   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   3   3   1   0   0   0   4   5   5   4   0   0   0   6   4   4   6   0   0   0   4   5   5   4   0   0   0   1   3   3   1
// 82     145      50    1494                                       1   4   6   4   1   0   0   4   2   3   2   4   0   0   6   3   1   3   6   0   0   4   2   3   2   4   0   0   1   4   6   4   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   4   6   4   1   0   0   4   2   3   2   4   0   0   6   3   1   3   6   0   0   4   2   3   2   4   0   0   1   4   6   4   1
// 83     146      60    1554                                     1   5   3   3   5   1   0   4   6   5   5   6   4   0   6   2   4   4   2   6   0   4   6   5   5   6   4   0   1   5   3   3   5   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   5   3   3   5   1   0   4   6   5   5   6   4   0   6   2   4   4   2   6   0   4   6   5   5   6   4   0   1   5   3   3   5   1
// 84     150      70    1624                                   1   6   1   6   1   6   1   4   3   4   3   4   3   4   6   1   6   1   6   1   6   4   3   4   3   4   3   4   1   6   1   6   1   6   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   6   1   6   1   6   1   4   3   4   3   4   3   4   6   1   6   1   6   1   6   4   3   4   3   4   3   4   1   6   1   6   1   6   1
// 85     151      12    1636                                 1   0   0   0   0   0   0   5   0   0   0   0   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   5   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   5   0   0   0   0   0   0   3   0   0   0   0   0   0   3   0   0   0   0   0   0   5   0   0   0   0   0   0   1
// 86     152      24    1660                               1   1   0   0   0   0   0   5   5   0   0   0   0   0   3   3   0   0   0   0   0   3   3   0   0   0   0   0   5   5   0   0   0   0   0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   0   0   0   0   5   5   0   0   0   0   0   3   3   0   0   0   0   0   3   3   0   0   0   0   0   5   5   0   0   0   0   0   1   1
// 87     153      36    1696                             1   2   1   0   0   0   0   5   3   5   0   0   0   0   3   6   3   0   0   0   0   3   6   3   0   0   0   0   5   3   5   0   0   0   0   1   2   1   0   0   0   0   0   0   0   0   0   0   0   1   2   1   0   0   0   0   5   3   5   0   0   0   0   3   6   3   0   0   0   0   3   6   3   0   0   0   0   5   3   5   0   0   0   0   1   2   1
// 88     154      48    1744                           1   3   3   1   0   0   0   5   1   1   5   0   0   0   3   2   2   3   0   0   0   3   2   2   3   0   0   0   5   1   1   5   0   0   0   1   3   3   1   0   0   0   0   0   0   0   0   0   0   1   3   3   1   0   0   0   5   1   1   5   0   0   0   3   2   2   3   0   0   0   3   2   2   3   0   0   0   5   1   1   5   0   0   0   1   3   3   1
// 89     155      60    1804                         1   4   6   4   1   0   0   5   6   2   6   5   0   0   3   5   4   5   3   0   0   3   5   4   5   3   0   0   5   6   2   6   5   0   0   1   4   6   4   1   0   0   0   0   0   0   0   0   0   1   4   6   4   1   0   0   5   6   2   6   5   0   0   3   5   4   5   3   0   0   3   5   4   5   3   0   0   5   6   2   6   5   0   0   1   4   6   4   1
// 90     156      72    1876                       1   5   3   3   5   1   0   5   4   1   1   4   5   0   3   1   2   2   1   3   0   3   1   2   2   1   3   0   5   4   1   1   4   5   0   1   5   3   3   5   1   0   0   0   0   0   0   0   0   1   5   3   3   5   1   0   5   4   1   1   4   5   0   3   1   2   2   1   3   0   3   1   2   2   1   3   0   5   4   1   1   4   5   0   1   5   3   3   5   1
// 91     160      84    1960                     1   6   1   6   1   6   1   5   2   5   2   5   2   5   3   4   3   4   3   4   3   3   4   3   4   3   4   3   5   2   5   2   5   2   5   1   6   1   6   1   6   1   0   0   0   0   0   0   0   1   6   1   6   1   6   1   5   2   5   2   5   2   5   3   4   3   4   3   4   3   3   4   3   4   3   4   3   5   2   5   2   5   2   5   1   6   1   6   1   6   1
// 92     161      14    1974                   1   0   0   0   0   0   0   6   0   0   0   0   0   0   1   0   0   0   0   0   0   6   0   0   0   0   0   0   1   0   0   0   0   0   0   6   0   0   0   0   0   0   1   0   0   0   0   0   0   1   0   0   0   0   0   0   6   0   0   0   0   0   0   1   0   0   0   0   0   0   6   0   0   0   0   0   0   1   0   0   0   0   0   0   6   0   0   0   0   0   0   1
// 93     612      28    2002                 1   1   0   0   0   0   0   6   6   0   0   0   0   0   1   1   0   0   0   0   0   6   6   0   0   0   0   0   1   1   0   0   0   0   0   6   6   0   0   0   0   0   1   1   0   0   0   0   0   1   1   0   0   0   0   0   6   6   0   0   0   0   0   1   1   0   0   0   0   0   6   6   0   0   0   0   0   1   1   0   0   0   0   0   6   6   0   0   0   0   0   1   1
// 94     163      42    2044               1   2   1   0   0   0   0   6   5   6   0   0   0   0   1   2   1   0   0   0   0   6   5   6   0   0   0   0   1   2   1   0   0   0   0   6   5   6   0   0   0   0   1   2   1   0   0   0   0   1   2   1   0   0   0   0   6   5   6   0   0   0   0   1   2   1   0   0   0   0   6   5   6   0   0   0   0   1   2   1   0   0   0   0   6   5   6   0   0   0   0   1   2   1
// 95     164      56    2100             1   3   3   1   0   0   0   6   4   4   6   0   0   0   1   3   3   1   0   0   0   6   4   4   6   0   0   0   1   3   3   1   0   0   0   6   4   4   6   0   0   0   1   3   3   1   0   0   0   1   3   3   1   0   0   0   6   4   4   6   0   0   0   1   3   3   1   0   0   0   6   4   4   6   0   0   0   1   3   3   1   0   0   0   6   4   4   6   0   0   0   1   3   3   1
// 96     165      70    2170           1   4   6   4   1   0   0   6   3   1   3   6   0   0   1   4   6   4   1   0   0   6   3   1   3   6   0   0   1   4   6   4   1   0   0   6   3   1   3   6   0   0   1   4   6   4   1   0   0   1   4   6   4   1   0   0   6   3   1   3   6   0   0   1   4   6   4   1   0   0   6   3   1   3   6   0   0   1   4   6   4   1   0   0   6   3   1   3   6   0   0   1   4   6   4   1
// 97     166      84    2254         1   5   3   3   5   1   0   6   2   4   4   2   6   0   1   5   3   3   5   1   0   6   2   4   4   2   6   0   1   5   3   3   5   1   0   6   2   4   4   2   6   0   1   5   3   3   5   1   0   1   5   3   3   5   1   0   6   2   4   4   2   6   0   1   5   3   3   5   1   0   6   2   4   4   2   6   0   1   5   3   3   5   1   0   6   2   4   4   2   6   0   1   5   3   3   5   1
// 98     200      98    2352       1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1   6   1
// 99     201       3    2355     1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1
//100     202       6    2361   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1]

// We can see now it's more like a mod 7 Sierpinski gasket, not quite as simple as
// originally thought. Let's zoom out one fractal level, using the triangle formed
// by the first 7 rows as the new atomic unit, ignoring the 0s and visualize what
// it looks like:
//
// Rows   base 7    not   total
//  1-7     10       28     28                                 1
//  8-14    20       56     84                               1   1
// 15-21    30       84    168                             1   2   1
// 22-28    40      112    280                           1   3   3   1
// 29-35    50      140    420                         1   4   6   4   1
// 36-42    60      168    588                       1   5   3   3   5   1
// 43-49   100      196    784                     1   6   1   6   1   6   1
// 50-56   110       56    840                   1   0   0   0   0   0   0   1
// 57-63   120      112    952                 1   1   0   0   0   0   0   1   1
// 64-70   130      168   1120               1   2   1   0   0   0   0   1   2   1
// 71-77   140      224   1344             1   3   3   1   0   0   0   1   3   3   1
// 78-84   150      280   1624           1   4   6   4   1   0   0   1   4   6   4   1
// 85-91   160      336   1960         1   5   3   3   5   1   0   1   5   3   3   5   1
// 92-98   200      392   2352       1   6   1   6   1   6   1   1   6   1   6   1   6   1   
// 99-100  202        9   2361     1   0   0   0   0   0   0   2   0   0   0   0   0   0   1
//
// Here we see the recursive fractal nature of this system - the numbers are identical
// to the mod 7 Pascal's Triangle above!
//
// The number of non-multiples of 7 in the atomic unit = 1 + 2 + 3 + 4 + 5 + 6 + 7 = 28.
// If we look at the totals in the "not multiples of 7" column, we see it is always
// a multiple of 28, with a scale factor equal to the number of non-zero values in that
// meta-row - 1, 2, 3, 4, 5, 6, 7, 2, 4, 5, 8, 10, 12, 14, 3, ...
//

// Repeat with the second generation block of 7^2 = 49 rows:
// Rows   mult 7    not
//  1-49   441      784                                 1
// 50-98  2058     1568                               1   1
//
// In the first level of recursion, the number of numbers not multiples of 7 are multiples of 28.
// In the second level of recursion, the numbers are multiples of 784 = 28^2.

// We can see interesting relationships between the totals of different rows:
//   1 ==   1_7 =    1
//   7 ==  10_7 =   28 =  1 * 28
//  49 == 100_7 =  784 = 28 * 28
//
//  8  ==  11_7 =   30
// 56  == 110_7 =  840 = 30 * 28
//
//  9  ==  12_7 =   34
// 63  == 120_7 =  952 = 34 * 28
//
// 10  ==  13_7 =   40
// 70  == 130_7 = 1120 = 40 * 28
//
// 11  ==  14_7 =   48
// 77  == 140_7 = 1344 = 48 * 28
//
// 12  ==  15_7 =   58
// 84  == 150_7 = 1624 = 58 * 28
//
// 13  ==  16_7 =   70
// 91  == 160_7 = 1960 = 70 * 28
//
// 14  ==  20_7 =   84
// 98  == 200_7 = 2352 = 84 * 28
//
// So multiplying by 7 (or left shifting 1 position base 7) results in a 28-fold
// increase in the number of non-multiples of 7 in the rows.
//
//  4  ==   4_7 =   10
// 
//  7  ==  10_7 =   28
// 11  ==  14_7 =   48 - diff = 20
//
// 14  ==  20_7 =   84
// 18  ==  24_7 =  114 - diff = 30
//
// 21  ==  30_7 =  168
// 25  ==  34_7 =  208 - diff = 40
//
// 28  ==  40_7 =  280
// 32  ==  44_7 =  330 - diff = 50
//
// 35  ==  50_7 =  420
// 39  ==  54_7 =  480 - diff = 60
//
// 42  ==  60_7 =  588
// 46  ==  64_7 =  658 - diff = 70
//
// 49  == 100_7 =  784
// 53  == 104_7 =  804 - diff = 20
//
// 56  == 110_7 =  840
// 60  == 114_7 =  880 - diff = 40
//
// 63  == 120_7 =  952
// 67  == 124_7 = 1012 - diff = 60
//
// 70  == 130_7 = 1120
// 74  == 134_7 = 1200 - diff = 80
//
// 77  == 140_7 = 1344
// 81  == 144_7 = 1444 - diff = 100
//
// 84  == 150_7 = 1624
// 88  == 154_7 = 1744 - diff = 120
//
// 91  == 160_7 = 1960
// 95  == 164_7 = 2100 - diff = 140
//
// To go from AB0_7 to ABN_7, you take the total of row N and multiply by
// (A + 1) * (B + 1)
//


uint64_t solve(uint64_t num_rows) {
    const std::vector<uint64_t> TriangularNumbers{ 0, 1, 3, 6, 10, 15, 21 };

    std::vector<uint64_t> pow7{ 1 };
    std::vector<uint64_t> pow28{ 1 };
    while (pow7.back() < num_rows) {
        pow7.push_back(pow7.back() * 7);
        pow28.push_back(pow28.back() * 28);
    }

    // Special case of a power of 7 number of rows.
    if (pow7.back() == num_rows)
        return pow28.back();

    // The last element of pow7 > num_rows, remove it and last of pow28.
    pow7.pop_back();
    pow28.pop_back();

    std::vector<uint64_t> base_7_digits;

    while (!pow7.empty()) {
        base_7_digits.push_back(num_rows / pow7.back());
        num_rows %= pow7.back();
        pow7.pop_back();
    }

    uint64_t ret{ TriangularNumbers[base_7_digits.front()]};
    uint64_t scale{ base_7_digits.front() + 1 };
    for (size_t ind = 1; ind < base_7_digits.size(); ++ind) {
        ret *= 28;
        ret += scale * TriangularNumbers[base_7_digits[ind]];
        scale *= base_7_digits[ind] + 1;
    }

    return ret;
}


int main()
{
    std::cout << "Hello World!\n";

    {
        for (uint64_t nr = 1; nr <= 100; ++nr) {
            auto counts = solve(nr);
            std::cout << nr << " rows, number of non-multiples of 7 = " << counts << std::endl;
        }
    }

    {
        constexpr uint64_t num_rows{ 1'000'000'000 };
        auto counts = solve(num_rows);
        std::cout << num_rows << " rows, number of non-multiples of 7 = " << counts << std::endl;
    }
}
